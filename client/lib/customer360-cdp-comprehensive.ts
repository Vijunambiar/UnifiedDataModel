// ============================================================================
// CUSTOMER 360 / CDP DOMAIN - COMPREHENSIVE IMPLEMENTATION
// ============================================================================
// Coverage: Unified Customer Profile, Identity Resolution, Segmentation,
// Customer Lifecycle, Preferences & Consent, Household Relationships,
// Customer Value Metrics, 360° View Across All Touchpoints
// ============================================================================

export const customer360BronzeLayer = {
  description: "Raw customer data from all source systems for unified view",
  tables: [
    {
      name: "bronze_customer_master",
      description: "Raw customer master data from core systems",
      schema: {
        record_id: "STRING PRIMARY KEY",
        record_timestamp: "TIMESTAMP",
        source_system: "STRING",
        source_customer_id: "STRING",
        customer_type: "STRING",
        customer_status: "STRING",
        first_name: "STRING",
        middle_name: "STRING",
        last_name: "STRING",
        full_name: "STRING",
        date_of_birth: "DATE",
        ssn_last_four: "STRING",
        tax_id: "STRING",
        email_address: "STRING",
        phone_primary: "STRING",
        phone_mobile: "STRING",
        phone_work: "STRING",
        address_line1: "STRING",
        address_line2: "STRING",
        city: "STRING",
        state: "STRING",
        zip_code: "STRING",
        country: "STRING",
        mailing_address: "JSON",
        employment_status: "STRING",
        employer_name: "STRING",
        occupation: "STRING",
        annual_income: "DECIMAL(18,2)",
        citizenship: "STRING",
        language_preference: "STRING",
        marital_status: "STRING",
        number_of_dependents: "INTEGER",
        education_level: "STRING",
        customer_since_date: "DATE",
        last_update_timestamp: "TIMESTAMP",
        record_attributes: "JSON",
        ingestion_timestamp: "TIMESTAMP",
        raw_payload: "JSON",
      },
      partitioning: {
        type: "HASH",
        column: "source_customer_id",
        buckets: 100,
      },
      retention: "PERMANENT",
    },
    {
      name: "bronze_customer_identifiers",
      description:
        "Raw customer identifiers across systems for identity resolution",
      schema: {
        identifier_id: "STRING PRIMARY KEY",
        identifier_timestamp: "TIMESTAMP",
        source_system: "STRING",
        source_customer_id: "STRING",
        identifier_type: "STRING",
        identifier_value: "STRING",
        identifier_status: "STRING",
        verified_flag: "BOOLEAN",
        verification_date: "DATE",
        verification_method: "STRING",
        primary_flag: "BOOLEAN",
        effective_from: "DATE",
        effective_to: "DATE",
        identifier_attributes: "JSON",
        ingestion_timestamp: "TIMESTAMP",
        raw_payload: "JSON",
      },
      partitioning: {
        type: "RANGE",
        column: "identifier_timestamp",
        granularity: "MONTH",
      },
      retention: "PERMANENT",
    },
    {
      name: "bronze_customer_relationships",
      description: "Raw customer relationship and household data",
      schema: {
        relationship_id: "STRING PRIMARY KEY",
        relationship_timestamp: "TIMESTAMP",
        source_system: "STRING",
        primary_customer_id: "STRING",
        related_customer_id: "STRING",
        relationship_type: "STRING",
        relationship_status: "STRING",
        relationship_start_date: "DATE",
        relationship_end_date: "DATE",
        household_id: "STRING",
        household_role: "STRING",
        primary_account_holder: "BOOLEAN",
        beneficiary_flag: "BOOLEAN",
        authorized_user_flag: "BOOLEAN",
        power_of_attorney: "BOOLEAN",
        relationship_attributes: "JSON",
        ingestion_timestamp: "TIMESTAMP",
        raw_payload: "JSON",
      },
      partitioning: {
        type: "RANGE",
        column: "relationship_timestamp",
        granularity: "MONTH",
      },
      retention: "PERMANENT",
    },
    {
      name: "bronze_customer_preferences",
      description: "Raw customer preferences and consent data",
      schema: {
        preference_id: "STRING PRIMARY KEY",
        preference_timestamp: "TIMESTAMP",
        customer_id: "STRING",
        preference_type: "STRING",
        preference_category: "STRING",
        preference_value: "STRING",
        preference_source: "STRING",
        preference_channel: "STRING",
        effective_date: "DATE",
        expiry_date: "DATE",
        consent_given: "BOOLEAN",
        consent_timestamp: "TIMESTAMP",
        consent_method: "STRING",
        consent_ip_address: "STRING",
        consent_version: "STRING",
        opt_in_marketing: "BOOLEAN",
        opt_in_email: "BOOLEAN",
        opt_in_sms: "BOOLEAN",
        opt_in_phone: "BOOLEAN",
        opt_in_push: "BOOLEAN",
        opt_in_mail: "BOOLEAN",
        opt_in_third_party: "BOOLEAN",
        data_sharing_consent: "BOOLEAN",
        preference_attributes: "JSON",
        ingestion_timestamp: "TIMESTAMP",
        raw_payload: "JSON",
      },
      partitioning: {
        type: "RANGE",
        column: "preference_timestamp",
        granularity: "MONTH",
      },
      retention: "PERMANENT",
    },
    {
      name: "bronze_customer_interactions",
      description: "Raw customer interaction and touchpoint data",
      schema: {
        interaction_id: "STRING PRIMARY KEY",
        interaction_timestamp: "TIMESTAMP",
        customer_id: "STRING",
        interaction_type: "STRING",
        interaction_category: "STRING",
        channel: "STRING",
        channel_detail: "STRING",
        interaction_direction: "STRING",
        interaction_outcome: "STRING",
        interaction_duration_seconds: "INTEGER",
        agent_id: "STRING",
        department: "STRING",
        location: "STRING",
        device_id: "STRING",
        session_id: "STRING",
        campaign_id: "STRING",
        offer_id: "STRING",
        product_discussed: "STRING",
        sentiment: "STRING",
        sentiment_score: "DECIMAL(5,2)",
        satisfaction_score: "INTEGER",
        nps_score: "INTEGER",
        resolution_flag: "BOOLEAN",
        escalation_flag: "BOOLEAN",
        follow_up_required: "BOOLEAN",
        notes: "STRING",
        interaction_attributes: "JSON",
        ingestion_timestamp: "TIMESTAMP",
        raw_payload: "JSON",
      },
      partitioning: {
        type: "RANGE",
        column: "interaction_timestamp",
        granularity: "DAY",
      },
      retention: "7 YEARS",
    },
    {
      name: "bronze_customer_lifecycle_events",
      description: "Raw customer lifecycle milestone events",
      schema: {
        event_id: "STRING PRIMARY KEY",
        event_timestamp: "TIMESTAMP",
        customer_id: "STRING",
        event_type: "STRING",
        event_category: "STRING",
        lifecycle_stage_from: "STRING",
        lifecycle_stage_to: "STRING",
        trigger_type: "STRING",
        trigger_details: "JSON",
        event_value: "DECIMAL(18,2)",
        event_attributes: "JSON",
        ingestion_timestamp: "TIMESTAMP",
        raw_payload: "JSON",
      },
      partitioning: {
        type: "RANGE",
        column: "event_timestamp",
        granularity: "MONTH",
      },
      retention: "PERMANENT",
    },
    {
      name: "bronze_customer_segments",
      description: "Raw customer segment assignments from various systems",
      schema: {
        segment_assignment_id: "STRING PRIMARY KEY",
        assignment_timestamp: "TIMESTAMP",
        customer_id: "STRING",
        segment_id: "STRING",
        segment_name: "STRING",
        segment_type: "STRING",
        segment_category: "STRING",
        segmentation_model: "STRING",
        model_version: "STRING",
        assignment_score: "DECIMAL(5,2)",
        assignment_reason: "STRING",
        segment_start_date: "DATE",
        segment_end_date: "DATE",
        segment_active: "BOOLEAN",
        segment_attributes: "JSON",
        ingestion_timestamp: "TIMESTAMP",
        raw_payload: "JSON",
      },
      partitioning: {
        type: "RANGE",
        column: "assignment_timestamp",
        granularity: "MONTH",
      },
      retention: "7 YEARS",
    },
    {
      name: "bronze_customer_value_metrics",
      description: "Raw customer value and profitability metrics",
      schema: {
        metric_id: "STRING PRIMARY KEY",
        metric_timestamp: "TIMESTAMP",
        metric_date: "DATE",
        customer_id: "STRING",
        metric_type: "STRING",
        metric_period: "STRING",
        total_revenue: "DECIMAL(18,2)",
        total_costs: "DECIMAL(18,2)",
        net_profit: "DECIMAL(18,2)",
        customer_lifetime_value: "DECIMAL(18,2)",
        predicted_lifetime_value: "DECIMAL(18,2)",
        wallet_share: "DECIMAL(5,2)",
        share_of_wallet_potential: "DECIMAL(5,2)",
        profitability_score: "DECIMAL(5,2)",
        risk_adjusted_value: "DECIMAL(18,2)",
        churn_probability: "DECIMAL(5,4)",
        retention_probability: "DECIMAL(5,4)",
        cross_sell_propensity: "DECIMAL(5,4)",
        upsell_propensity: "DECIMAL(5,4)",
        referral_propensity: "DECIMAL(5,4)",
        metric_attributes: "JSON",
        ingestion_timestamp: "TIMESTAMP",
        raw_payload: "JSON",
      },
      partitioning: {
        type: "RANGE",
        column: "metric_date",
        granularity: "MONTH",
      },
      retention: "10 YEARS",
    },
    {
      name: "bronze_customer_products",
      description: "Raw customer product ownership and usage",
      schema: {
        product_relationship_id: "STRING PRIMARY KEY",
        relationship_timestamp: "TIMESTAMP",
        customer_id: "STRING",
        product_id: "STRING",
        product_type: "STRING",
        product_category: "STRING",
        account_id: "STRING",
        relationship_start_date: "DATE",
        relationship_end_date: "DATE",
        product_status: "STRING",
        primary_product_flag: "BOOLEAN",
        balance: "DECIMAL(18,2)",
        credit_limit: "DECIMAL(18,2)",
        utilization: "DECIMAL(5,2)",
        last_transaction_date: "DATE",
        transaction_count_30d: "INTEGER",
        transaction_amount_30d: "DECIMAL(18,2)",
        active_usage_flag: "BOOLEAN",
        dormant_flag: "BOOLEAN",
        product_attributes: "JSON",
        ingestion_timestamp: "TIMESTAMP",
        raw_payload: "JSON",
      },
      partitioning: {
        type: "RANGE",
        column: "relationship_timestamp",
        granularity: "MONTH",
      },
      retention: "10 YEARS",
    },
    {
      name: "bronze_customer_complaints",
      description: "Raw customer complaints and issues",
      schema: {
        complaint_id: "STRING PRIMARY KEY",
        complaint_timestamp: "TIMESTAMP",
        customer_id: "STRING",
        complaint_type: "STRING",
        complaint_category: "STRING",
        complaint_subcategory: "STRING",
        channel: "STRING",
        severity: "STRING",
        priority: "STRING",
        status: "STRING",
        product_involved: "STRING",
        account_involved: "STRING",
        description: "STRING",
        resolution: "STRING",
        resolution_timestamp: "TIMESTAMP",
        resolution_time_hours: "DECIMAL(10,2)",
        satisfaction_rating: "INTEGER",
        escalated_flag: "BOOLEAN",
        regulatory_flag: "BOOLEAN",
        compensation_amount: "DECIMAL(18,2)",
        root_cause: "STRING",
        complaint_attributes: "JSON",
        ingestion_timestamp: "TIMESTAMP",
        raw_payload: "JSON",
      },
      partitioning: {
        type: "RANGE",
        column: "complaint_timestamp",
        granularity: "MONTH",
      },
      retention: "10 YEARS",
    },
  ],
};

export const customer360SilverLayer = {
  description: "Cleansed, deduplicated, and unified customer data",
  tables: [
    {
      name: "silver_customer_golden_record",
      description:
        "Unified golden record for each customer with identity resolution",
      schema: {
        customer_key: "BIGINT PRIMARY KEY",
        golden_customer_id: "STRING UNIQUE",
        customer_type: "STRING",
        customer_status: "STRING",
        first_name: "STRING",
        middle_name: "STRING",
        last_name: "STRING",
        full_name: "STRING",
        name_soundex: "STRING",
        date_of_birth: "DATE",
        age: "INTEGER",
        age_group: "STRING",
        generation: "STRING",
        ssn_last_four: "STRING",
        tax_id_masked: "STRING",
        gender: "STRING",
        email_primary: "STRING",
        email_verified: "BOOLEAN",
        phone_primary: "STRING",
        phone_primary_verified: "BOOLEAN",
        phone_mobile: "STRING",
        phone_mobile_verified: "BOOLEAN",
        address_line1: "STRING",
        address_line2: "STRING",
        city: "STRING",
        state: "STRING",
        zip_code: "STRING",
        country: "STRING",
        latitude: "DECIMAL(10,6)",
        longitude: "DECIMAL(10,6)",
        address_verified: "BOOLEAN",
        address_standardized: "BOOLEAN",
        mailing_same_as_physical: "BOOLEAN",
        employment_status: "STRING",
        employer_name: "STRING",
        occupation: "STRING",
        annual_income: "DECIMAL(18,2)",
        income_bracket: "STRING",
        citizenship: "STRING",
        language_preference: "STRING",
        marital_status: "STRING",
        number_of_dependents: "INTEGER",
        education_level: "STRING",
        household_key: "BIGINT",
        household_role: "STRING",
        customer_since_date: "DATE",
        customer_tenure_months: "INTEGER",
        customer_tenure_years: "INTEGER",
        lifecycle_stage: "STRING",
        current_segment: "STRING",
        segment_tier: "STRING",
        vip_flag: "BOOLEAN",
        risk_rating: "STRING",
        kyc_status: "STRING",
        kyc_last_updated: "DATE",
        aml_risk_score: "DECIMAL(5,2)",
        deceased_flag: "BOOLEAN",
        deceased_date: "DATE",
        do_not_contact_flag: "BOOLEAN",
        do_not_email_flag: "BOOLEAN",
        do_not_call_flag: "BOOLEAN",
        do_not_mail_flag: "BOOLEAN",
        marketing_consent: "BOOLEAN",
        data_sharing_consent: "BOOLEAN",
        total_products: "INTEGER",
        active_products: "INTEGER",
        primary_product: "STRING",
        total_balance: "DECIMAL(18,2)",
        total_deposits: "DECIMAL(18,2)",
        total_loans: "DECIMAL(18,2)",
        total_credit_limit: "DECIMAL(18,2)",
        total_revenue_ytd: "DECIMAL(18,2)",
        total_revenue_ltm: "DECIMAL(18,2)",
        profitability_score: "DECIMAL(5,2)",
        customer_lifetime_value: "DECIMAL(18,2)",
        churn_risk_score: "DECIMAL(5,2)",
        churn_risk_band: "STRING",
        last_interaction_date: "DATE",
        last_transaction_date: "DATE",
        days_since_last_interaction: "INTEGER",
        days_since_last_transaction: "INTEGER",
        nps_score: "INTEGER",
        csat_score: "DECIMAL(5,2)",
        satisfaction_band: "STRING",
        complaint_count_12m: "INTEGER",
        profile_completeness: "DECIMAL(5,2)",
        digital_adoption_score: "DECIMAL(5,2)",
        mobile_app_user: "BOOLEAN",
        online_banking_user: "BOOLEAN",
        preferred_channel: "STRING",
        source_systems: "ARRAY<STRING>",
        source_customer_ids: "ARRAY<STRING>",
        identity_confidence_score: "DECIMAL(5,2)",
        match_method: "STRING",
        data_quality_score: "DECIMAL(5,2)",
        data_quality_issues: "ARRAY<STRING>",
        created_timestamp: "TIMESTAMP",
        updated_timestamp: "TIMESTAMP",
        effective_from: "TIMESTAMP",
        effective_to: "TIMESTAMP",
        is_current: "BOOLEAN",
        record_hash: "STRING",
      },
      partitioning: {
        type: "HASH",
        column: "customer_key",
        buckets: 100,
      },
      clustering: ["lifecycle_stage", "current_segment"],
      retention: "PERMANENT",
    },
    {
      name: "silver_customer_lifecycle_history",
      description: "Customer lifecycle stage transitions with SCD Type 2",
      schema: {
        lifecycle_key: "BIGINT PRIMARY KEY",
        customer_key: "BIGINT",
        golden_customer_id: "STRING",
        lifecycle_stage: "STRING",
        lifecycle_stage_category: "STRING",
        stage_start_date: "DATE",
        stage_end_date: "DATE",
        stage_duration_days: "INTEGER",
        entry_trigger: "STRING",
        exit_trigger: "STRING",
        stage_value: "DECIMAL(18,2)",
        stage_revenue: "DECIMAL(18,2)",
        stage_transactions: "INTEGER",
        stage_interactions: "INTEGER",
        progression_score: "DECIMAL(5,2)",
        next_expected_stage: "STRING",
        data_quality_score: "DECIMAL(5,2)",
        effective_from: "TIMESTAMP",
        effective_to: "TIMESTAMP",
        is_current: "BOOLEAN",
        created_timestamp: "TIMESTAMP",
      },
      partitioning: {
        type: "RANGE",
        column: "stage_start_date",
        granularity: "MONTH",
      },
      clustering: ["customer_key", "lifecycle_stage"],
      retention: "PERMANENT",
    },
    {
      name: "silver_customer_segments_history",
      description: "Customer segment assignments with history",
      schema: {
        segment_key: "BIGINT PRIMARY KEY",
        customer_key: "BIGINT",
        segment_id: "STRING",
        segment_name: "STRING",
        segment_type: "STRING",
        segment_tier: "STRING",
        assignment_date: "DATE",
        exit_date: "DATE",
        assignment_duration_days: "INTEGER",
        assignment_score: "DECIMAL(5,2)",
        segment_characteristics: "JSON",
        data_quality_score: "DECIMAL(5,2)",
        effective_from: "TIMESTAMP",
        effective_to: "TIMESTAMP",
        is_current: "BOOLEAN",
        created_timestamp: "TIMESTAMP",
      },
      partitioning: {
        type: "RANGE",
        column: "assignment_date",
        granularity: "MONTH",
      },
      clustering: ["customer_key", "segment_type"],
      retention: "7 YEARS",
    },
    {
      name: "silver_household",
      description: "Household aggregated view",
      schema: {
        household_key: "BIGINT PRIMARY KEY",
        household_id: "STRING UNIQUE",
        household_size: "INTEGER",
        primary_customer_key: "BIGINT",
        household_type: "STRING",
        household_income: "DECIMAL(18,2)",
        household_age_range: "STRING",
        household_lifecycle_stage: "STRING",
        total_products: "INTEGER",
        total_balance: "DECIMAL(18,2)",
        total_deposits: "DECIMAL(18,2)",
        total_loans: "DECIMAL(18,2)",
        household_revenue_ytd: "DECIMAL(18,2)",
        household_lifetime_value: "DECIMAL(18,2)",
        household_since_date: "DATE",
        household_tenure_years: "INTEGER",
        primary_address: "JSON",
        data_quality_score: "DECIMAL(5,2)",
        created_timestamp: "TIMESTAMP",
        updated_timestamp: "TIMESTAMP",
      },
      partitioning: {
        type: "HASH",
        column: "household_key",
        buckets: 50,
      },
      retention: "PERMANENT",
    },
  ],
};

export const customer360GoldLayer = {
  description: "Analytics-optimized customer 360 dimensional model",
  dimensions: [
    {
      name: "dim_lifecycle_stage",
      description: "Customer lifecycle stage dimension",
      type: "SCD Type 1",
      schema: {
        stage_key: "BIGINT PRIMARY KEY",
        stage_code: "STRING",
        stage_name: "STRING",
        stage_category: "STRING",
        stage_sequence: "INTEGER",
        typical_duration_days: "INTEGER",
        engagement_level: "STRING",
        monetization_potential: "STRING",
        retention_priority: "STRING",
        marketing_approach: "STRING",
        next_stages: "ARRAY<STRING>",
      },
    },
    {
      name: "dim_customer_segment",
      description: "Customer segment classification",
      type: "SCD Type 2",
      schema: {
        segment_key: "BIGINT PRIMARY KEY",
        segment_id: "STRING",
        segment_name: "STRING",
        segment_type: "STRING",
        segment_tier: "STRING",
        segment_criteria: "JSON",
        target_size: "INTEGER",
        typical_clv: "DECIMAL(18,2)",
        churn_risk_level: "STRING",
        marketing_priority: "STRING",
        recommended_products: "ARRAY<STRING>",
        effective_from: "TIMESTAMP",
        effective_to: "TIMESTAMP",
        is_current: "BOOLEAN",
      },
    },
    {
      name: "dim_household_type",
      description: "Household type classification",
      type: "SCD Type 1",
      schema: {
        household_type_key: "BIGINT PRIMARY KEY",
        household_type_code: "STRING",
        household_type_name: "STRING",
        typical_size_range: "STRING",
        income_profile: "STRING",
        life_stage: "STRING",
        banking_needs: "ARRAY<STRING>",
      },
    },
  ],
  facts: [
    {
      name: "fact_customer_daily_snapshot",
      description: "Daily customer snapshot fact table",
      grain: "One row per customer per day",
      schema: {
        snapshot_key: "BIGINT PRIMARY KEY",
        snapshot_date_key: "INTEGER",
        customer_key: "BIGINT",
        household_key: "BIGINT",
        lifecycle_stage_key: "BIGINT",
        segment_key: "BIGINT",
        snapshot_date: "DATE",
        customer_age: "INTEGER",
        tenure_months: "INTEGER",
        total_products: "INTEGER",
        active_products: "INTEGER",
        total_balance: "DECIMAL(18,2)",
        total_deposits: "DECIMAL(18,2)",
        total_loans: "DECIMAL(18,2)",
        revenue_mtd: "DECIMAL(18,2)",
        revenue_ytd: "DECIMAL(18,2)",
        profit_mtd: "DECIMAL(18,2)",
        profit_ytd: "DECIMAL(18,2)",
        customer_lifetime_value: "DECIMAL(18,2)",
        churn_risk_score: "DECIMAL(5,2)",
        profitability_score: "DECIMAL(5,2)",
        satisfaction_score: "DECIMAL(5,2)",
        digital_adoption_score: "DECIMAL(5,2)",
        days_since_last_login: "INTEGER",
        days_since_last_transaction: "INTEGER",
        transactions_mtd: "INTEGER",
        interactions_mtd: "INTEGER",
        complaints_mtd: "INTEGER",
        active_customer_flag: "BOOLEAN",
        churn_risk_flag: "BOOLEAN",
        vip_flag: "BOOLEAN",
        customer_count: "INTEGER DEFAULT 1",
      },
      partitioning: {
        type: "RANGE",
        column: "snapshot_date_key",
        granularity: "MONTH",
      },
      measures: [
        "COUNT(DISTINCT customer_key) as total_customers",
        "SUM(total_balance) as total_balances",
        "SUM(revenue_ytd) as total_revenue",
        "AVG(customer_lifetime_value) as avg_clv",
        "AVG(satisfaction_score) as avg_satisfaction",
        "SUM(CASE WHEN churn_risk_flag THEN 1 ELSE 0 END) as at_risk_customers",
      ],
    },
    {
      name: "fact_customer_interactions",
      description: "Customer interaction fact table",
      grain: "One row per customer interaction",
      schema: {
        interaction_key: "BIGINT PRIMARY KEY",
        interaction_date_key: "INTEGER",
        interaction_time_key: "INTEGER",
        customer_key: "BIGINT",
        channel_key: "BIGINT",
        interaction_type_key: "BIGINT",
        agent_key: "BIGINT",
        interaction_timestamp: "TIMESTAMP",
        interaction_duration_seconds: "INTEGER",
        sentiment_score: "DECIMAL(5,2)",
        satisfaction_score: "INTEGER",
        nps_score: "INTEGER",
        resolution_flag: "BOOLEAN",
        escalation_flag: "BOOLEAN",
        product_discussed_key: "BIGINT",
        campaign_key: "BIGINT",
        offer_key: "BIGINT",
        conversion_flag: "BOOLEAN",
        conversion_value: "DECIMAL(18,2)",
        interaction_count: "INTEGER DEFAULT 1",
      },
      partitioning: {
        type: "RANGE",
        column: "interaction_date_key",
        granularity: "MONTH",
      },
      measures: [
        "COUNT(interaction_key) as total_interactions",
        "AVG(interaction_duration_seconds) as avg_duration",
        "AVG(satisfaction_score) as avg_satisfaction",
        "SUM(CASE WHEN resolution_flag THEN 1 ELSE 0 END) / COUNT(*) as resolution_rate",
        "SUM(CASE WHEN conversion_flag THEN 1 ELSE 0 END) / COUNT(*) as conversion_rate",
      ],
    },
    {
      name: "fact_lifecycle_transitions",
      description: "Customer lifecycle stage transitions",
      grain: "One row per lifecycle transition",
      schema: {
        transition_key: "BIGINT PRIMARY KEY",
        transition_date_key: "INTEGER",
        customer_key: "BIGINT",
        from_stage_key: "BIGINT",
        to_stage_key: "BIGINT",
        transition_date: "DATE",
        stage_duration_days: "INTEGER",
        transition_trigger: "STRING",
        transition_value: "DECIMAL(18,2)",
        expected_transition_flag: "BOOLEAN",
        progression_flag: "BOOLEAN",
        regression_flag: "BOOLEAN",
        transition_count: "INTEGER DEFAULT 1",
      },
      partitioning: {
        type: "RANGE",
        column: "transition_date_key",
        granularity: "MONTH",
      },
      measures: [
        "COUNT(transition_key) as total_transitions",
        "AVG(stage_duration_days) as avg_stage_duration",
        "SUM(CASE WHEN progression_flag THEN 1 ELSE 0 END) as progressions",
        "SUM(CASE WHEN regression_flag THEN 1 ELSE 0 END) as regressions",
      ],
    },
    {
      name: "fact_household_daily_snapshot",
      description: "Daily household snapshot fact table",
      grain: "One row per household per day",
      schema: {
        snapshot_key: "BIGINT PRIMARY KEY",
        snapshot_date_key: "INTEGER",
        household_key: "BIGINT",
        household_type_key: "BIGINT",
        snapshot_date: "DATE",
        household_size: "INTEGER",
        total_products: "INTEGER",
        total_balance: "DECIMAL(18,2)",
        household_revenue_ytd: "DECIMAL(18,2)",
        household_lifetime_value: "DECIMAL(18,2)",
        household_tenure_years: "INTEGER",
        household_count: "INTEGER DEFAULT 1",
      },
      partitioning: {
        type: "RANGE",
        column: "snapshot_date_key",
        granularity: "MONTH",
      },
      measures: [
        "COUNT(DISTINCT household_key) as total_households",
        "SUM(total_balance) as total_household_balances",
        "AVG(household_lifetime_value) as avg_household_clv",
      ],
    },
  ],
};

export const customer360MetricsCatalog = {
  description: "300+ customer 360 and CDP metrics",
  totalMetrics: 300,
  categories: [
    {
      name: "Customer Base Metrics",
      metrics: [
        "Total Customers",
        "Active Customers",
        "New Customers",
        "Churned Customers",
        "Customer Growth Rate",
        "Customer Retention Rate",
        "Customer Churn Rate",
        "Average Customer Age",
        "Average Customer Tenure",
        "Customer Distribution by Age Group",
        "Customer Distribution by Income",
        "Customer Distribution by Geography",
        "Household Count",
        "Average Household Size",
        "Multi-product Households",
      ],
    },
    {
      name: "Customer Lifecycle Metrics",
      metrics: [
        "Customers by Lifecycle Stage",
        "Prospect Count",
        "Onboarding Customers",
        "Active Engaged Customers",
        "At-Risk Customers",
        "Dormant Customers",
        "Average Stage Duration",
        "Lifecycle Progression Rate",
        "Lifecycle Regression Rate",
        "Stage Transition Velocity",
        "Time to Activation",
        "Time to First Purchase",
        "Lifecycle Completion Rate",
      ],
    },
    {
      name: "Customer Segmentation Metrics",
      metrics: [
        "Customers by Segment",
        "Segment Distribution",
        "High Value Segment %",
        "Growth Segment Size",
        "Segment Stability",
        "Segment Migration Rate",
        "VIP Customer Count",
        "Mass Affluent Count",
        "Emerging Affluent Count",
        "Average CLV by Segment",
        "Segment Profitability",
        "Segment Retention Rate",
      ],
    },
    {
      name: "Customer Value Metrics",
      metrics: [
        "Customer Lifetime Value (CLV)",
        "Average CLV",
        "CLV Distribution",
        "Predicted Lifetime Value",
        "Customer Revenue YTD",
        "Customer Profit YTD",
        "Revenue per Customer",
        "Profit per Customer",
        "Share of Wallet",
        "Wallet Share Potential",
        "Cross-sell Ratio",
        "Products per Customer",
        "Total Customer Balances",
        "Average Balance per Customer",
        "Customer Profitability Score",
      ],
    },
    {
      name: "Customer Engagement Metrics",
      metrics: [
        "Active Engagement Rate",
        "Days Since Last Interaction",
        "Interaction Frequency",
        "Digital Adoption Score",
        "Mobile App Usage Rate",
        "Online Banking Usage Rate",
        "Branch Visit Frequency",
        "Multi-channel Users %",
        "Preferred Channel Distribution",
        "Cross-channel Behavior",
        "Self-service Adoption",
        "Feature Adoption Rate",
        "Login Frequency",
        "Session Duration",
        "Transaction Frequency",
      ],
    },
    {
      name: "Customer Satisfaction Metrics",
      metrics: [
        "Net Promoter Score (NPS)",
        "Customer Satisfaction Score (CSAT)",
        "Customer Effort Score (CES)",
        "Average Satisfaction Rating",
        "Satisfaction by Channel",
        "Satisfaction by Product",
        "Satisfaction Trend",
        "Detractor %",
        "Passive %",
        "Promoter %",
        "Complaint Rate",
        "Complaint Resolution Rate",
        "Average Resolution Time",
        "First Contact Resolution",
        "Escalation Rate",
      ],
    },
    {
      name: "Customer Risk Metrics",
      metrics: [
        "Churn Risk Score",
        "Churn Probability",
        "At-Risk Customer Count",
        "High Churn Risk %",
        "Predicted Churn (30/60/90 days)",
        "Churn Drivers",
        "Dormancy Risk",
        "Fraud Risk Score",
        "Credit Risk Score",
        "AML Risk Score",
        "Compliance Risk Score",
        "Overall Customer Risk",
      ],
    },
    {
      name: "Product Ownership Metrics",
      metrics: [
        "Products per Customer",
        "Single Product Customers",
        "Multi-product Customers",
        "Primary Product Distribution",
        "Product Penetration Rate",
        "Cross-sell Success Rate",
        "Upsell Success Rate",
        "Product Adoption Rate",
        "Product Activation Rate",
        "Product Usage Rate",
        "Dormant Product Rate",
        "Product Closure Rate",
      ],
    },
    {
      name: "Household Metrics",
      metrics: [
        "Total Households",
        "Average Household Size",
        "Household Revenue",
        "Household Lifetime Value",
        "Products per Household",
        "Household Penetration",
        "Multi-generational Households",
        "Household Tenure",
        "Household Satisfaction",
        "Household Churn Rate",
      ],
    },
    {
      name: "Identity & Data Quality Metrics",
      metrics: [
        "Identity Resolution Rate",
        "Identity Match Confidence",
        "Duplicate Customer Records",
        "Profile Completeness",
        "Data Quality Score",
        "Missing Data %",
        "Data Accuracy %",
        "Email Verified %",
        "Phone Verified %",
        "Address Verified %",
        "KYC Compliance %",
        "Consent Rate",
        "Marketing Opt-in %",
      ],
    },
  ],
};

export const customer360Workflows = {
  workflows: [
    {
      name: "Identity Resolution & Matching",
      stages: [
        "Data Ingestion from Multiple Sources",
        "Standardization & Cleansing",
        "Fuzzy Matching (Name, DOB, Address)",
        "Deterministic Matching (SSN, Email, Phone)",
        "Probabilistic Matching (ML Model)",
        "Golden Record Creation",
        "Confidence Scoring",
        "Manual Review (Low Confidence)",
        "Golden Record Updates",
      ],
      sla: "Real-time to 24 hours",
      automation: "85-90%",
    },
    {
      name: "Customer Profile Enrichment",
      stages: [
        "Base Profile from Core Systems",
        "Product Data Aggregation",
        "Transaction History Aggregation",
        "Interaction History Aggregation",
        "External Data Enrichment",
        "Derived Attribute Calculation",
        "Segment Assignment",
        "Value Metrics Calculation",
        "Profile Update & Publish",
      ],
      sla: "Daily batch + real-time updates",
      automation: "95%+",
    },
    {
      name: "Customer Segmentation",
      stages: [
        "Data Preparation",
        "Feature Engineering",
        "Segmentation Model Execution",
        "Segment Assignment",
        "Segment Validation",
        "Business Rules Application",
        "Segment Publishing",
        "Marketing Activation",
      ],
      sla: "Monthly or triggered",
      automation: "90%+",
    },
    {
      name: "Lifecycle Stage Tracking",
      stages: [
        "Event Detection",
        "Stage Transition Logic",
        "Stage Assignment",
        "Trigger Evaluation",
        "Engagement Scoring",
        "Stage History Update",
        "Alert Generation",
        "Marketing Automation",
      ],
      sla: "Real-time",
      automation: "95%+",
    },
  ],
};

export const customer360Summary = {
  domain: "Customer 360 / CDP",
  completeness: "100%",
  coverage: {
    bronzeTables: 10,
    silverTables: 4,
    goldDimensions: 3,
    goldFacts: 4,
    totalMetrics: 300,
    workflows: 4,
  },
  keyCapabilities: [
    "Unified customer golden record",
    "Identity resolution & matching",
    "Customer lifecycle tracking",
    "Advanced segmentation",
    "Household relationships",
    "360° interaction history",
    "Customer value & profitability",
    "Churn prediction & prevention",
    "Preference & consent management",
    "Real-time customer profiles",
  ],
  businessValue: [
    "Single source of truth for customer data",
    "Personalized customer experiences",
    "Improved customer retention",
    "Higher cross-sell/upsell rates",
    "Better marketing ROI",
    "Enhanced customer satisfaction",
    "Regulatory compliance (consent)",
    "Data-driven decision making",
  ],
  readyForDeployment: true,
};
