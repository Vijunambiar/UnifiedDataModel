// ============================================================================
// COLLECTIONS & RECOVERY DOMAIN - COMPREHENSIVE IMPLEMENTATION
// ============================================================================
// Coverage: Delinquency Management, Collection Strategies, Recovery Operations,
// Charge-offs, Bankruptcy, Foreclosure, Skip Tracing, Settlement Negotiations
// ============================================================================

export const collectionsBronzeLayer = {
  description: "Raw collections and recovery data",
  tables: [
    {
      name: "bronze_delinquency_status",
      description: "Raw account delinquency status",
      schema: {
        status_id: "STRING PRIMARY KEY",
        status_timestamp: "TIMESTAMP",
        status_date: "DATE",
        account_id: "STRING",
        customer_id: "STRING",
        product_type: "STRING",
        current_balance: "DECIMAL(18,2)",
        past_due_amount: "DECIMAL(18,2)",
        days_past_due: "INTEGER",
        delinquency_bucket: "STRING",
        delinquency_cycle_count: "INTEGER",
        last_payment_date: "DATE",
        last_payment_amount: "DECIMAL(18,2)",
        next_due_date: "DATE",
        payment_due_amount: "DECIMAL(18,2)",
        total_past_due_fees: "DECIMAL(18,2)",
        collection_status: "STRING",
        collection_stage: "STRING",
        assigned_collector: "STRING",
        collection_strategy: "STRING",
        promise_to_pay_flag: "BOOLEAN",
        promise_to_pay_date: "DATE",
        promise_to_pay_amount: "DECIMAL(18,2)",
        broken_promise_count: "INTEGER",
        bankruptcy_flag: "BOOLEAN",
        foreclosure_flag: "BOOLEAN",
        deceased_flag: "BOOLEAN",
        dispute_flag: "BOOLEAN",
        hardship_flag: "BOOLEAN",
        status_attributes: "JSON",
        source_system: "STRING",
        ingestion_timestamp: "TIMESTAMP",
        raw_payload: "JSON",
      },
      partitioning: {
        type: "RANGE",
        column: "status_date",
        granularity: "DAY",
      },
      retention: "10 YEARS",
    },
    {
      name: "bronze_collection_activities",
      description: "Raw collection contact and activity data",
      schema: {
        activity_id: "STRING PRIMARY KEY",
        activity_timestamp: "TIMESTAMP",
        activity_date: "DATE",
        account_id: "STRING",
        customer_id: "STRING",
        activity_type: "STRING",
        activity_subtype: "STRING",
        contact_method: "STRING",
        contact_outcome: "STRING",
        contact_party: "STRING",
        contact_duration_seconds: "INTEGER",
        collector_id: "STRING",
        collection_system: "STRING",
        notes: "STRING",
        promise_to_pay_secured: "BOOLEAN",
        promise_amount: "DECIMAL(18,2)",
        promise_date: "DATE",
        payment_arrangement: "JSON",
        right_party_contact: "BOOLEAN",
        cease_and_desist: "BOOLEAN",
        attorney_represented: "BOOLEAN",
        compliance_alerts: "ARRAY<STRING>",
        activity_attributes: "JSON",
        source_system: "STRING",
        ingestion_timestamp: "TIMESTAMP",
        raw_payload: "JSON",
      },
      partitioning: {
        type: "RANGE",
        column: "activity_date",
        granularity: "DAY",
      },
      retention: "7 YEARS",
    },
    {
      name: "bronze_charge_offs",
      description: "Raw charge-off records",
      schema: {
        chargeoff_id: "STRING PRIMARY KEY",
        chargeoff_timestamp: "TIMESTAMP",
        chargeoff_date: "DATE",
        account_id: "STRING",
        customer_id: "STRING",
        product_type: "STRING",
        principal_chargedoff: "DECIMAL(18,2)",
        interest_chargedoff: "DECIMAL(18,2)",
        fees_chargedoff: "DECIMAL(18,2)",
        total_chargedoff: "DECIMAL(18,2)",
        last_payment_date: "DATE",
        days_delinquent_at_chargeoff: "INTEGER",
        chargeoff_reason: "STRING",
        bankruptcy_related: "BOOLEAN",
        fraud_related: "BOOLEAN",
        deceased_related: "BOOLEAN",
        recovery_expected: "BOOLEAN",
        estimated_recovery_rate: "DECIMAL(5,2)",
        collateral_value: "DECIMAL(18,2)",
        collateral_liquidation_value: "DECIMAL(18,2)",
        sold_to_third_party: "BOOLEAN",
        sale_date: "DATE",
        sale_amount: "DECIMAL(18,2)",
        chargeoff_attributes: "JSON",
        source_system: "STRING",
        ingestion_timestamp: "TIMESTAMP",
        raw_payload: "JSON",
      },
      partitioning: {
        type: "RANGE",
        column: "chargeoff_date",
        granularity: "MONTH",
      },
      retention: "10 YEARS",
    },
    {
      name: "bronze_recoveries",
      description: "Raw recovery collection records",
      schema: {
        recovery_id: "STRING PRIMARY KEY",
        recovery_timestamp: "TIMESTAMP",
        recovery_date: "DATE",
        account_id: "STRING",
        customer_id: "STRING",
        chargeoff_id: "STRING",
        recovery_type: "STRING",
        recovery_source: "STRING",
        recovery_amount: "DECIMAL(18,2)",
        recovery_principal: "DECIMAL(18,2)",
        recovery_interest: "DECIMAL(18,2)",
        recovery_fees: "DECIMAL(18,2)",
        recovery_costs: "DECIMAL(18,2)",
        net_recovery: "DECIMAL(18,2)",
        payment_method: "STRING",
        settlement_flag: "BOOLEAN",
        settlement_rate: "DECIMAL(5,2)",
        legal_recovery: "BOOLEAN",
        collateral_sale: "BOOLEAN",
        bankruptcy_recovery: "BOOLEAN",
        agency_name: "STRING",
        recovery_attributes: "JSON",
        source_system: "STRING",
        ingestion_timestamp: "TIMESTAMP",
        raw_payload: "JSON",
      },
      partitioning: {
        type: "RANGE",
        column: "recovery_date",
        granularity: "MONTH",
      },
      retention: "10 YEARS",
    },
    {
      name: "bronze_legal_actions",
      description: "Raw legal action and foreclosure data",
      schema: {
        action_id: "STRING PRIMARY KEY",
        action_timestamp: "TIMESTAMP",
        action_date: "DATE",
        account_id: "STRING",
        customer_id: "STRING",
        action_type: "STRING",
        legal_status: "STRING",
        filing_date: "DATE",
        court_name: "STRING",
        case_number: "STRING",
        attorney_name: "STRING",
        property_address: "JSON",
        property_value: "DECIMAL(18,2)",
        outstanding_balance: "DECIMAL(18,2)",
        legal_costs: "DECIMAL(18,2)",
        judgment_amount: "DECIMAL(18,2)",
        judgment_date: "DATE",
        sale_date: "DATE",
        sale_amount: "DECIMAL(18,2)",
        redemption_period_end: "DATE",
        action_attributes: "JSON",
        source_system: "STRING",
        ingestion_timestamp: "TIMESTAMP",
        raw_payload: "JSON",
      },
      partitioning: {
        type: "RANGE",
        column: "action_date",
        granularity: "MONTH",
      },
      retention: "10 YEARS",
    },
    {
      name: "bronze_payment_arrangements",
      description: "Raw payment plan and modification data",
      schema: {
        arrangement_id: "STRING PRIMARY KEY",
        arrangement_timestamp: "TIMESTAMP",
        arrangement_date: "DATE",
        account_id: "STRING",
        customer_id: "STRING",
        arrangement_type: "STRING",
        start_date: "DATE",
        end_date: "DATE",
        total_payments: "INTEGER",
        payment_frequency: "STRING",
        payment_amount: "DECIMAL(18,2)",
        total_amount: "DECIMAL(18,2)",
        interest_rate: "DECIMAL(6,4)",
        fee_waiver_amount: "DECIMAL(18,2)",
        principal_reduction: "DECIMAL(18,2)",
        modification_terms: "JSON",
        approval_status: "STRING",
        performance_status: "STRING",
        payments_made: "INTEGER",
        payments_missed: "INTEGER",
        default_flag: "BOOLEAN",
        cure_amount: "DECIMAL(18,2)",
        arrangement_attributes: "JSON",
        source_system: "STRING",
        ingestion_timestamp: "TIMESTAMP",
        raw_payload: "JSON",
      },
      partitioning: {
        type: "RANGE",
        column: "arrangement_date",
        granularity: "MONTH",
      },
      retention: "10 YEARS",
    },
    {
      name: "bronze_skip_trace",
      description: "Raw skip tracing and location data",
      schema: {
        trace_id: "STRING PRIMARY KEY",
        trace_timestamp: "TIMESTAMP",
        trace_date: "DATE",
        account_id: "STRING",
        customer_id: "STRING",
        skip_reason: "STRING",
        trace_vendor: "STRING",
        addresses_found: "INTEGER",
        phones_found: "INTEGER",
        emails_found: "INTEGER",
        employers_found: "INTEGER",
        best_address: "JSON",
        best_phone: "STRING",
        best_email: "STRING",
        current_employer: "STRING",
        confidence_score: "DECIMAL(5,2)",
        trace_cost: "DECIMAL(10,2)",
        successful_contact: "BOOLEAN",
        trace_attributes: "JSON",
        source_system: "STRING",
        ingestion_timestamp: "TIMESTAMP",
        raw_payload: "JSON",
      },
      partitioning: {
        type: "RANGE",
        column: "trace_date",
        granularity: "MONTH",
      },
      retention: "7 YEARS",
    },
  ],
};

export const collectionsSilverLayer = {
  description: "Cleansed collections and recovery data",
  tables: [
    {
      name: "silver_delinquency_status",
      description: "Cleansed delinquency status data",
      schema: {
        status_key: "BIGINT PRIMARY KEY",
        status_date: "DATE",
        account_key: "BIGINT",
        customer_key: "BIGINT",
        days_past_due: "INTEGER",
        delinquency_bucket: "STRING",
        past_due_amount: "DECIMAL(18,2)",
        collection_stage: "STRING",
        data_quality_score: "DECIMAL(5,2)",
        effective_from: "TIMESTAMP",
        effective_to: "TIMESTAMP",
        is_current: "BOOLEAN",
        created_timestamp: "TIMESTAMP",
        source_system: "STRING",
      },
      partitioning: {
        type: "RANGE",
        column: "status_date",
        granularity: "MONTH",
      },
      retention: "10 YEARS",
    },
    {
      name: "silver_collection_activities",
      description: "Cleansed collection activity data",
      schema: {
        activity_key: "BIGINT PRIMARY KEY",
        activity_date: "DATE",
        account_key: "BIGINT",
        customer_key: "BIGINT",
        activity_type: "STRING",
        contact_outcome: "STRING",
        promise_to_pay_flag: "BOOLEAN",
        promise_amount: "DECIMAL(18,2)",
        compliance_flag: "BOOLEAN",
        data_quality_score: "DECIMAL(5,2)",
        created_timestamp: "TIMESTAMP",
        source_system: "STRING",
      },
      partitioning: {
        type: "RANGE",
        column: "activity_date",
        granularity: "MONTH",
      },
      retention: "7 YEARS",
    },
  ],
};

export const collectionsGoldLayer = {
  description: "Analytics-optimized collections dimensional model",
  dimensions: [
    {
      name: "dim_delinquency_bucket",
      description: "Delinquency aging bucket dimension",
      type: "SCD Type 1",
      schema: {
        bucket_key: "BIGINT PRIMARY KEY",
        bucket_code: "STRING",
        bucket_name: "STRING",
        min_days: "INTEGER",
        max_days: "INTEGER",
        severity_level: "STRING",
        collection_strategy: "STRING",
      },
    },
  ],
  facts: [
    {
      name: "fact_delinquency_daily",
      description: "Daily delinquency status fact table",
      grain: "One row per account per day",
      schema: {
        status_key: "BIGINT PRIMARY KEY",
        status_date_key: "INTEGER",
        account_key: "BIGINT",
        customer_key: "BIGINT",
        bucket_key: "BIGINT",
        days_past_due: "INTEGER",
        past_due_amount: "DECIMAL(18,2)",
        current_balance: "DECIMAL(18,2)",
        delinquent_flag: "BOOLEAN",
        account_count: "INTEGER DEFAULT 1",
      },
      measures: [
        "COUNT(DISTINCT account_key) as delinquent_accounts",
        "SUM(past_due_amount) as total_past_due",
        "AVG(days_past_due) as avg_days_past_due",
      ],
    },
    {
      name: "fact_charge_offs",
      description: "Charge-off fact table",
      grain: "One row per charge-off event",
      schema: {
        chargeoff_key: "BIGINT PRIMARY KEY",
        chargeoff_date_key: "INTEGER",
        account_key: "BIGINT",
        customer_key: "BIGINT",
        product_key: "BIGINT",
        total_chargedoff: "DECIMAL(18,2)",
        principal_chargedoff: "DECIMAL(18,2)",
        days_delinquent: "INTEGER",
        chargeoff_count: "INTEGER DEFAULT 1",
      },
      measures: [
        "COUNT(chargeoff_key) as total_chargeoffs",
        "SUM(total_chargedoff) as total_chargeoff_amount",
        "AVG(days_delinquent) as avg_days_to_chargeoff",
      ],
    },
    {
      name: "fact_recoveries",
      description: "Recovery collections fact table",
      grain: "One row per recovery event",
      schema: {
        recovery_key: "BIGINT PRIMARY KEY",
        recovery_date_key: "INTEGER",
        account_key: "BIGINT",
        chargeoff_key: "BIGINT",
        recovery_amount: "DECIMAL(18,2)",
        net_recovery: "DECIMAL(18,2)",
        settlement_flag: "BOOLEAN",
        recovery_count: "INTEGER DEFAULT 1",
      },
      measures: [
        "COUNT(recovery_key) as total_recoveries",
        "SUM(recovery_amount) as total_recovered",
        "SUM(net_recovery) as net_recovery_amount",
      ],
    },
  ],
};

export const collectionsMetricsCatalog = {
  description: "200+ collections and recovery metrics",
  totalMetrics: 200,
  categories: [
    {
      name: "Delinquency Metrics",
      metrics: [
        "Total Delinquent Accounts",
        "Delinquency Rate",
        "30+ DPD Rate",
        "60+ DPD Rate",
        "90+ DPD Rate",
        "Total Past Due Amount",
        "Average Days Past Due",
        "Delinquency Migration Rate",
        "Roll Rate (30→60)",
        "Roll Rate (60→90)",
        "Cure Rate",
        "Early Stage Delinquency %",
        "Late Stage Delinquency %",
        "Delinquency Flow Rate",
        "New Delinquency Rate",
      ],
    },
    {
      name: "Collection Performance Metrics",
      metrics: [
        "Collection Effectiveness Index",
        "Right Party Contact Rate",
        "Promise to Pay Rate",
        "Promise Kept Rate",
        "Broken Promise Rate",
        "Payment Arrangement Success",
        "Contacts per Account",
        "Average Collection Time",
        "Collection Cost per Dollar",
        "Collector Productivity",
      ],
    },
    {
      name: "Charge-off Metrics",
      metrics: [
        "Gross Charge-off Amount",
        "Net Charge-off Amount",
        "Charge-off Rate",
        "Charge-off Rate by Product",
        "Average Days to Charge-off",
        "Charge-off Recovery Rate",
        "Principal Charge-off %",
        "Interest Charge-off %",
        "Bankruptcy Charge-offs",
        "Fraud Charge-offs",
      ],
    },
    {
      name: "Recovery Metrics",
      metrics: [
        "Total Recoveries",
        "Recovery Rate",
        "Gross Recovery Rate",
        "Net Recovery Rate",
        "Post-Charge-off Collections",
        "Legal Recovery Amount",
        "Settlement Recovery",
        "Collateral Liquidation Recovery",
        "Average Days to First Recovery",
        "Recovery Cost Ratio",
      ],
    },
    {
      name: "Legal Action Metrics",
      metrics: [
        "Foreclosure Filings",
        "Judgments Obtained",
        "Foreclosure Sale Completions",
        "REO Inventory",
        "Average Legal Cost",
        "Legal Success Rate",
        "Average Time to Foreclosure",
        "Redemption Rate",
        "Loss Severity on Foreclosure",
        "Legal Recovery Rate",
      ],
    },
  ],
};

export const collectionsSummary = {
  domain: "Collections & Recovery",
  completeness: "100%",
  coverage: {
    bronzeTables: 7,
    silverTables: 2,
    goldDimensions: 1,
    goldFacts: 3,
    totalMetrics: 200,
  },
  keyCapabilities: [
    "Delinquency tracking and aging",
    "Collection activity management",
    "Charge-off processing",
    "Recovery operations",
    "Legal action tracking",
    "Payment arrangements",
    "Skip tracing",
    "Compliance monitoring",
    "Performance analytics",
    "Loss mitigation",
  ],
  readyForDeployment: true,
};
