/**
 * CUSTOMER DOMAIN - COMPREHENSIVE METRICS CATALOG
 * 
 * 50+ business metrics with SQL formulas and definitions
 * Organized by business categories
 * Production-ready KPIs for reporting and analysis
 */

export const customerMetricsCatalog = {
  description: 'Comprehensive customer domain metrics catalog',
  totalMetrics: 52,
  
  categories: [
    // Category 1: Volume & Growth Metrics (12 metrics)
    {
      name: 'Volume & Growth Metrics',
      description: 'Customer acquisition, growth, and base size metrics',
      totalMetrics: 12,
      
      metrics: [
        {
          id: 'CUST-VOL-001',
          name: 'Total Active Customers',
          description: 'Count of unique active customers',
          category: 'Volume',
          type: 'operational',
          formula: "SELECT COUNT(DISTINCT customer_key) FROM gold.dim_customer WHERE is_current = true",
          businessLogic: 'Count all active customer records in current dimension',
          dataType: 'INTEGER',
          unit: 'count',
          aggregation: 'SUM',
          granularity: 'Daily',
          sourceTables: ['gold.dim_customer'],
        },
        {
          id: 'CUST-VOL-002',
          name: 'New Customers (Month)',
          description: 'Number of new customer acquisitions in current month',
          formula: "SELECT COUNT(DISTINCT customer_key) FROM gold.fact_customer_lifecycle_events WHERE event_type = 'Acquisition' AND MONTH(event_date_key) = MONTH(CURRENT_DATE)",
          businessLogic: 'Count acquisition events in current calendar month',
          dataType: 'INTEGER',
          unit: 'count',
          aggregation: 'SUM',
          granularity: 'Monthly',
          sourceTables: ['gold.fact_customer_lifecycle_events'],
        },
        {
          id: 'CUST-VOL-003',
          name: 'Customer Churn Rate',
          description: 'Monthly customer churn rate as percentage',
          formula: "SELECT (COUNT(DISTINCT c1.customer_key) FILTER (WHERE c1.is_current = false AND c2.is_current = true) / NULLIF(COUNT(DISTINCT c2.customer_key), 0)) * 100 FROM gold.dim_customer c1 FULL OUTER JOIN gold.dim_customer c2",
          businessLogic: 'Churned customers / Previous period active customers * 100',
          dataType: 'DECIMAL',
          unit: 'percentage',
          aggregation: 'AVG',
          granularity: 'Monthly',
          sourceTables: ['gold.dim_customer'],
        },
        {
          id: 'CUST-VOL-004',
          name: 'Customer Retention Rate',
          description: 'Percentage of customers retained month-over-month',
          formula: "SELECT (1 - (churned_customers / NULLIF(previous_active_customers, 0))) * 100 AS retention_rate",
          businessLogic: '100% - Churn Rate',
          dataType: 'DECIMAL',
          unit: 'percentage',
          aggregation: 'AVG',
          granularity: 'Monthly',
          sourceTables: ['gold.dim_customer'],
        },
        {
          id: 'CUST-VOL-005',
          name: 'Net Customer Growth',
          description: 'Net change in active customer base month-over-month',
          formula: "SELECT (new_customers - churned_customers) AS net_growth FROM (SELECT COUNT(DISTINCT customer_key) as new_customers FROM gold.fact_customer_lifecycle_events WHERE event_type = 'Acquisition')",
          businessLogic: 'New acquisitions - Churned customers',
          dataType: 'INTEGER',
          unit: 'count',
          aggregation: 'SUM',
          granularity: 'Monthly',
          sourceTables: ['gold.fact_customer_lifecycle_events'],
        },
        {
          id: 'CUST-VOL-006',
          name: 'Reactivated Customers',
          description: 'Customers reactivated from inactive status',
          formula: "SELECT COUNT(DISTINCT customer_key) FROM gold.fact_customer_lifecycle_events WHERE event_type = 'Reactivation'",
          businessLogic: 'Count reactivation lifecycle events',
          dataType: 'INTEGER',
          unit: 'count',
          aggregation: 'SUM',
          granularity: 'Monthly',
          sourceTables: ['gold.fact_customer_lifecycle_events'],
        },
        {
          id: 'CUST-VOL-007',
          name: 'Customer Growth Rate (YoY)',
          description: 'Year-over-year customer growth percentage',
          formula: "SELECT ((current_year_customers - prior_year_customers) / NULLIF(prior_year_customers, 0)) * 100",
          businessLogic: '(Current Year Total - Prior Year Total) / Prior Year Total * 100',
          dataType: 'DECIMAL',
          unit: 'percentage',
          aggregation: 'AVG',
          granularity: 'Yearly',
          sourceTables: ['gold.dim_customer'],
        },
        {
          id: 'CUST-VOL-008',
          name: 'Customers by Segment',
          description: 'Distribution of customers across segments',
          formula: "SELECT segment, COUNT(DISTINCT customer_key) FROM gold.dim_customer WHERE is_current = true GROUP BY segment",
          businessLogic: 'Count distinct customers grouped by segment',
          dataType: 'INTEGER',
          unit: 'count',
          aggregation: 'SUM',
          granularity: 'Monthly',
          sourceTables: ['gold.dim_customer'],
        },
        {
          id: 'CUST-VOL-009',
          name: 'Premium Tier Growth',
          description: 'Growth rate of Premier/Premium customers',
          formula: "SELECT ((premier_current - premier_prior) / NULLIF(premier_prior, 0)) * 100",
          businessLogic: 'Growth % of high-value customer segments',
          dataType: 'DECIMAL',
          unit: 'percentage',
          aggregation: 'AVG',
          granularity: 'Monthly',
          sourceTables: ['gold.dim_customer'],
        },
        {
          id: 'CUST-VOL-010',
          name: 'Emerging Market Penetration',
          description: 'Customer penetration in emerging affluent segment',
          formula: "SELECT COUNT(DISTINCT customer_key) FROM gold.dim_customer WHERE net_worth_usd BETWEEN 250000 AND 1000000",
          businessLogic: 'Count customers in emerging affluent net worth range',
          dataType: 'INTEGER',
          unit: 'count',
          aggregation: 'SUM',
          granularity: 'Monthly',
          sourceTables: ['gold.dim_customer'],
        },
        {
          id: 'CUST-VOL-011',
          name: 'Customer Acquisition Cost Efficiency',
          description: 'Revenue per acquired customer',
          formula: "SELECT total_customer_revenue / total_new_customers AS acquisition_efficiency",
          businessLogic: 'Total revenue from new customers / Total cost of acquisition',
          dataType: 'DECIMAL',
          unit: 'USD',
          aggregation: 'AVG',
          granularity: 'Monthly',
          sourceTables: ['gold.fact_customer_lifecycle_events'],
        },
        {
          id: 'CUST-VOL-012',
          name: 'Inactive Customer Count',
          description: 'Customers with no activity in last 180 days',
          formula: "SELECT COUNT(DISTINCT customer_key) FROM gold.dim_customer WHERE days_since_last_transaction > 180",
          businessLogic: 'Count dormant customers',
          dataType: 'INTEGER',
          unit: 'count',
          aggregation: 'SUM',
          granularity: 'Daily',
          sourceTables: ['gold.dim_customer'],
        },
      ],
    },

    // Category 2: Revenue & Profitability Metrics (12 metrics)
    {
      name: 'Revenue & Profitability Metrics',
      description: 'Customer lifetime value, revenue, and profitability',
      totalMetrics: 12,
      
      metrics: [
        {
          id: 'CUST-REV-001',
          name: 'Total Customer Revenue',
          description: 'Total revenue generated from all customers',
          formula: "SELECT SUM(total_transaction_volume_usd) FROM gold.fact_customer_monthly_snapshot",
          businessLogic: 'Sum of all customer transaction volumes',
          dataType: 'DECIMAL',
          unit: 'USD',
          aggregation: 'SUM',
          granularity: 'Monthly',
          sourceTables: ['gold.fact_customer_monthly_snapshot'],
        },
        {
          id: 'CUST-REV-002',
          name: 'Average Customer Revenue (ACR)',
          description: 'Average revenue per active customer',
          formula: "SELECT SUM(total_transaction_volume_usd) / COUNT(DISTINCT customer_key) FROM gold.fact_customer_monthly_snapshot",
          businessLogic: 'Total revenue / Active customer count',
          dataType: 'DECIMAL',
          unit: 'USD',
          aggregation: 'AVG',
          granularity: 'Monthly',
          sourceTables: ['gold.fact_customer_monthly_snapshot'],
        },
        {
          id: 'CUST-REV-003',
          name: 'Customer Lifetime Value',
          description: 'Total predicted lifetime value of customer base',
          formula: "SELECT SUM(lifetime_value_usd) FROM gold.dim_customer WHERE is_current = true",
          businessLogic: 'Sum of all individual customer CLVs',
          dataType: 'DECIMAL',
          unit: 'USD',
          aggregation: 'SUM',
          granularity: 'Monthly',
          sourceTables: ['gold.dim_customer'],
        },
        {
          id: 'CUST-REV-004',
          name: 'Average CLV per Customer',
          description: 'Mean customer lifetime value',
          formula: "SELECT AVG(lifetime_value_usd) FROM gold.dim_customer WHERE is_current = true",
          businessLogic: 'Average of all individual customer CLVs',
          dataType: 'DECIMAL',
          unit: 'USD',
          aggregation: 'AVG',
          granularity: 'Monthly',
          sourceTables: ['gold.dim_customer'],
        },
        {
          id: 'CUST-REV-005',
          name: 'Revenue by Segment',
          description: 'Revenue breakdown by customer segment',
          formula: "SELECT segment, SUM(total_transaction_volume_usd) FROM gold.fact_customer_monthly_snapshot GROUP BY segment",
          businessLogic: 'Sum revenue per segment',
          dataType: 'DECIMAL',
          unit: 'USD',
          aggregation: 'SUM',
          granularity: 'Monthly',
          sourceTables: ['gold.fact_customer_monthly_snapshot'],
        },
        {
          id: 'CUST-REV-006',
          name: 'Net Worth Correlation to Revenue',
          description: 'Correlation between customer net worth and generated revenue',
          formula: "SELECT CORR(net_worth_usd, total_transaction_volume_usd) FROM gold.fact_customer_monthly_snapshot",
          businessLogic: 'Pearson correlation coefficient',
          dataType: 'DECIMAL',
          unit: 'ratio',
          aggregation: 'AVG',
          granularity: 'Monthly',
          sourceTables: ['gold.fact_customer_monthly_snapshot'],
        },
        {
          id: 'CUST-REV-007',
          name: 'Premier Customer Revenue Contribution',
          description: 'Percentage of total revenue from Premier segment',
          formula: "SELECT (SUM(CASE WHEN segment = 'Premier' THEN total_transaction_volume_usd ELSE 0 END) / NULLIF(SUM(total_transaction_volume_usd), 0)) * 100",
          businessLogic: 'Premier revenue / Total revenue * 100',
          dataType: 'DECIMAL',
          unit: 'percentage',
          aggregation: 'AVG',
          granularity: 'Monthly',
          sourceTables: ['gold.fact_customer_monthly_snapshot'],
        },
        {
          id: 'CUST-REV-008',
          name: 'Revenue per Geographic Region',
          description: 'Average revenue per customer by geography',
          formula: "SELECT geography_key, AVG(total_transaction_volume_usd) FROM gold.fact_customer_monthly_snapshot GROUP BY geography_key",
          businessLogic: 'Average revenue by region',
          dataType: 'DECIMAL',
          unit: 'USD',
          aggregation: 'AVG',
          granularity: 'Monthly',
          sourceTables: ['gold.fact_customer_monthly_snapshot'],
        },
        {
          id: 'CUST-REV-009',
          name: 'Cross-sell Revenue',
          description: 'Revenue from multiple products per customer',
          formula: "SELECT SUM(CASE WHEN active_products >= 3 THEN total_transaction_volume_usd ELSE 0 END) FROM gold.fact_customer_monthly_snapshot",
          businessLogic: 'Revenue from multi-product customers',
          dataType: 'DECIMAL',
          unit: 'USD',
          aggregation: 'SUM',
          granularity: 'Monthly',
          sourceTables: ['gold.fact_customer_monthly_snapshot'],
        },
        {
          id: 'CUST-REV-010',
          name: 'High-Value Customer Concentration',
          description: 'Percentage of revenue from top 20% of customers',
          formula: "SELECT (top_20pct_revenue / NULLIF(total_revenue, 0)) * 100",
          businessLogic: 'Revenue concentration index',
          dataType: 'DECIMAL',
          unit: 'percentage',
          aggregation: 'AVG',
          granularity: 'Monthly',
          sourceTables: ['gold.fact_customer_monthly_snapshot'],
        },
        {
          id: 'CUST-REV-011',
          name: 'Profitability Index',
          description: 'Revenue minus risk and compliance costs',
          formula: "SELECT (total_revenue - (risk_assessment_cost + compliance_cost)) / NULLIF(total_revenue, 0) * 100",
          businessLogic: 'Profitability margin %',
          dataType: 'DECIMAL',
          unit: 'percentage',
          aggregation: 'AVG',
          granularity: 'Monthly',
          sourceTables: ['gold.fact_customer_monthly_snapshot'],
        },
        {
          id: 'CUST-REV-012',
          name: 'Expansion Revenue per Customer',
          description: 'Incremental revenue from product expansion',
          formula: "SELECT SUM(expansion_revenue_usd) / COUNT(DISTINCT customer_key) FROM gold.fact_customer_lifecycle_events WHERE event_type IN ('Product Add', 'Upgrade')",
          businessLogic: 'Revenue from expansion events',
          dataType: 'DECIMAL',
          unit: 'USD',
          aggregation: 'AVG',
          granularity: 'Monthly',
          sourceTables: ['gold.fact_customer_lifecycle_events'],
        },
      ],
    },

    // Category 3: Engagement & Activation Metrics (10 metrics)
    {
      name: 'Engagement & Activation Metrics',
      description: 'Customer engagement, activity, and channel usage',
      totalMetrics: 10,
      
      metrics: [
        {
          id: 'CUST-ENG-001',
          name: 'Overall Customer Engagement Score',
          description: 'Composite engagement metric (0-100)',
          formula: "SELECT AVG((transaction_frequency_pct + channel_usage_pct + product_adoption_pct) / 3) FROM gold.fact_customer_monthly_snapshot",
          businessLogic: 'Average of normalized engagement dimensions',
          dataType: 'DECIMAL',
          unit: 'score',
          aggregation: 'AVG',
          granularity: 'Monthly',
          sourceTables: ['gold.fact_customer_monthly_snapshot'],
        },
        {
          id: 'CUST-ENG-002',
          name: 'Digital Channel Adoption Rate',
          description: 'Percentage of customers using digital channels',
          formula: "SELECT (COUNT(DISTINCT CASE WHEN mobile_login_count > 0 OR channel_login_count > 0 THEN customer_key END) / NULLIF(COUNT(DISTINCT customer_key), 0)) * 100",
          businessLogic: 'Count of digital users / Total customers',
          dataType: 'DECIMAL',
          unit: 'percentage',
          aggregation: 'AVG',
          granularity: 'Monthly',
          sourceTables: ['gold.fact_customer_monthly_snapshot'],
        },
        {
          id: 'CUST-ENG-003',
          name: 'Mobile-First Customer Percentage',
          description: 'Customers preferring mobile as primary channel',
          formula: "SELECT (COUNT(DISTINCT CASE WHEN mobile_login_count > branch_visit_count THEN customer_key END) / NULLIF(COUNT(DISTINCT customer_key), 0)) * 100",
          businessLogic: 'Count of mobile-primary users',
          dataType: 'DECIMAL',
          unit: 'percentage',
          aggregation: 'AVG',
          granularity: 'Monthly',
          sourceTables: ['gold.fact_customer_monthly_snapshot'],
        },
        {
          id: 'CUST-ENG-004',
          name: 'Average Transaction Frequency',
          description: 'Average monthly transactions per customer',
          formula: "SELECT AVG(number_of_transactions) FROM gold.fact_customer_monthly_snapshot",
          businessLogic: 'Average transaction count per customer',
          dataType: 'DECIMAL',
          unit: 'count',
          aggregation: 'AVG',
          granularity: 'Monthly',
          sourceTables: ['gold.fact_customer_monthly_snapshot'],
        },
        {
          id: 'CUST-ENG-005',
          name: 'Active Product Ownership Rate',
          description: 'Average number of active products per customer',
          formula: "SELECT AVG(active_products) FROM gold.fact_customer_monthly_snapshot",
          businessLogic: 'Average active product count',
          dataType: 'DECIMAL',
          unit: 'count',
          aggregation: 'AVG',
          granularity: 'Monthly',
          sourceTables: ['gold.fact_customer_monthly_snapshot'],
        },
        {
          id: 'CUST-ENG-006',
          name: 'Cross-Channel Engagement Index',
          description: 'Metric of multi-channel usage (omnichannel score)',
          formula: "SELECT AVG(CASE WHEN (mobile_login_count > 0 AND branch_visit_count > 0) THEN 100 WHEN (mobile_login_count > 0 OR branch_visit_count > 0) THEN 50 ELSE 0 END)",
          businessLogic: 'Score for multi-channel usage',
          dataType: 'DECIMAL',
          unit: 'score',
          aggregation: 'AVG',
          granularity: 'Monthly',
          sourceTables: ['gold.fact_customer_monthly_snapshot'],
        },
        {
          id: 'CUST-ENG-007',
          name: 'Days Since Last Transaction',
          description: 'Average days elapsed since customer last transacted',
          formula: "SELECT AVG(days_since_last_transaction) FROM gold.fact_customer_monthly_snapshot",
          businessLogic: 'Average recency metric',
          dataType: 'INTEGER',
          unit: 'days',
          aggregation: 'AVG',
          granularity: 'Daily',
          sourceTables: ['gold.fact_customer_monthly_snapshot'],
        },
        {
          id: 'CUST-ENG-008',
          name: 'High-Activity Customer Percentage',
          description: 'Customers in top quartile of transaction volume',
          formula: "SELECT (COUNT(DISTINCT CASE WHEN number_of_transactions >= 75th_percentile THEN customer_key END) / NULLIF(COUNT(DISTINCT customer_key), 0)) * 100",
          businessLogic: 'Percentage of highly engaged customers',
          dataType: 'DECIMAL',
          unit: 'percentage',
          aggregation: 'AVG',
          granularity: 'Monthly',
          sourceTables: ['gold.fact_customer_monthly_snapshot'],
        },
        {
          id: 'CUST-ENG-009',
          name: 'Self-Service Adoption',
          description: 'Percentage of transactions via self-service channels',
          formula: "SELECT (COUNT(DISTINCT CASE WHEN channel_login_count > 0 THEN customer_key END) / NULLIF(COUNT(DISTINCT customer_key), 0)) * 100",
          businessLogic: 'Self-service user percentage',
          dataType: 'DECIMAL',
          unit: 'percentage',
          aggregation: 'AVG',
          granularity: 'Monthly',
          sourceTables: ['gold.fact_customer_monthly_snapshot'],
        },
        {
          id: 'CUST-ENG-010',
          name: 'Branch Loyalty Index',
          description: 'Frequency of branch visits as engagement indicator',
          formula: "SELECT AVG(branch_visit_count) / NULLIF(AVG(number_of_transactions), 0) * 100 AS branch_loyalty",
          businessLogic: 'Branch visits / Total transactions',
          dataType: 'DECIMAL',
          unit: 'percentage',
          aggregation: 'AVG',
          granularity: 'Monthly',
          sourceTables: ['gold.fact_customer_monthly_snapshot'],
        },
      ],
    },

    // Category 4: Risk & Compliance Metrics (10 metrics)
    {
      name: 'Risk & Compliance Metrics',
      description: 'AML/KYC compliance, risk scoring, and regulatory metrics',
      totalMetrics: 10,
      
      metrics: [
        {
          id: 'CUST-RSK-001',
          name: 'Overall Risk Score (Average)',
          description: 'Average customer risk score across portfolio',
          formula: "SELECT AVG(overall_risk_score) FROM gold.fact_customer_risk_daily",
          businessLogic: 'Average risk score 0-100',
          dataType: 'DECIMAL',
          unit: 'score',
          aggregation: 'AVG',
          granularity: 'Daily',
          sourceTables: ['gold.fact_customer_risk_daily'],
        },
        {
          id: 'CUST-RSK-002',
          name: 'High-Risk Customer Count',
          description: 'Customers with risk score > 75',
          formula: "SELECT COUNT(DISTINCT customer_key) FROM gold.fact_customer_risk_daily WHERE overall_risk_score > 75",
          businessLogic: 'Count of high-risk customers',
          dataType: 'INTEGER',
          unit: 'count',
          aggregation: 'SUM',
          granularity: 'Daily',
          sourceTables: ['gold.fact_customer_risk_daily'],
        },
        {
          id: 'CUST-RSK-003',
          name: 'PEP/Sanctions Hit Rate',
          description: 'Percentage of customers with PEP or sanctions flags',
          formula: "SELECT (COUNT(DISTINCT CASE WHEN pep_flag = true OR sanctions_flag = true THEN customer_key END) / NULLIF(COUNT(DISTINCT customer_key), 0)) * 100",
          businessLogic: 'PEP + Sanctions customers / Total',
          dataType: 'DECIMAL',
          unit: 'percentage',
          aggregation: 'AVG',
          granularity: 'Daily',
          sourceTables: ['gold.fact_customer_risk_daily'],
        },
        {
          id: 'CUST-RSK-004',
          name: 'KYC Compliance Rate',
          description: 'Percentage of customers with verified KYC status',
          formula: "SELECT (COUNT(DISTINCT CASE WHEN kyc_status = 'Verified' OR kyc_status = 'Enhanced' THEN customer_key END) / NULLIF(COUNT(DISTINCT customer_key), 0)) * 100",
          businessLogic: 'KYC verified / Total customers',
          dataType: 'DECIMAL',
          unit: 'percentage',
          aggregation: 'AVG',
          granularity: 'Daily',
          sourceTables: ['gold.dim_customer'],
        },
        {
          id: 'CUST-RSK-005',
          name: 'AML Risk Distribution',
          description: 'Distribution of customers across AML risk levels',
          formula: "SELECT aml_risk_level, COUNT(DISTINCT customer_key) FROM gold.dim_customer GROUP BY aml_risk_level",
          businessLogic: 'Customer count by AML risk level',
          dataType: 'INTEGER',
          unit: 'count',
          aggregation: 'SUM',
          granularity: 'Daily',
          sourceTables: ['gold.dim_customer'],
        },
        {
          id: 'CUST-RSK-006',
          name: 'Customers Requiring Review',
          description: 'Customers flagged for compliance review',
          formula: "SELECT COUNT(DISTINCT customer_key) FROM gold.fact_customer_risk_daily WHERE requires_review = true",
          businessLogic: 'Count of customers needing action',
          dataType: 'INTEGER',
          unit: 'count',
          aggregation: 'SUM',
          granularity: 'Daily',
          sourceTables: ['gold.fact_customer_risk_daily'],
        },
        {
          id: 'CUST-RSK-007',
          name: 'Risk Review Timeliness',
          description: 'Average days overdue for risk review',
          formula: "SELECT AVG(DATEDIFF(day, last_review_date, CURRENT_DATE)) FROM gold.dim_customer WHERE last_review_date IS NOT NULL",
          businessLogic: 'Average review age',
          dataType: 'DECIMAL',
          unit: 'days',
          aggregation: 'AVG',
          granularity: 'Daily',
          sourceTables: ['gold.dim_customer'],
        },
        {
          id: 'CUST-RSK-008',
          name: 'Adverse Media Hit Rate',
          description: 'Percentage of customers with adverse media flags',
          formula: "SELECT (COUNT(DISTINCT CASE WHEN adverse_media_flag = true THEN customer_key END) / NULLIF(COUNT(DISTINCT customer_key), 0)) * 100",
          businessLogic: 'Adverse media customers / Total',
          dataType: 'DECIMAL',
          unit: 'percentage',
          aggregation: 'AVG',
          granularity: 'Daily',
          sourceTables: ['gold.fact_customer_risk_daily'],
        },
        {
          id: 'CUST-RSK-009',
          name: 'Critical Risk Priority Queue',
          description: 'Count of critical priority review items',
          formula: "SELECT COUNT(DISTINCT customer_key) FROM gold.fact_customer_risk_daily WHERE review_priority = 'Critical'",
          businessLogic: 'Count of urgent reviews',
          dataType: 'INTEGER',
          unit: 'count',
          aggregation: 'SUM',
          granularity: 'Daily',
          sourceTables: ['gold.fact_customer_risk_daily'],
        },
        {
          id: 'CUST-RSK-010',
          name: 'Data Quality Compliance Score',
          description: 'Average data completeness and accuracy score',
          formula: "SELECT AVG((completeness_score + accuracy_score) / 2) FROM gold.fact_customer_monthly_snapshot",
          businessLogic: 'Average data quality metric',
          dataType: 'DECIMAL',
          unit: 'percentage',
          aggregation: 'AVG',
          granularity: 'Monthly',
          sourceTables: ['gold.fact_customer_monthly_snapshot'],
        },
      ],
    },

    // Category 5: Customer Experience & Satisfaction (8 metrics)
    {
      name: 'Customer Experience & Satisfaction',
      description: 'NPS, satisfaction, and loyalty metrics',
      totalMetrics: 8,
      
      metrics: [
        {
          id: 'CUST-EXP-001',
          name: 'Net Promoter Score (NPS)',
          description: 'Overall customer recommendation likelihood',
          formula: "SELECT ((COUNT(CASE WHEN nps_score >= 9 THEN 1 END) - COUNT(CASE WHEN nps_score <= 6 THEN 1 END)) / NULLIF(COUNT(*), 0)) * 100",
          businessLogic: '(Promoters - Detractors) / Total * 100',
          dataType: 'DECIMAL',
          unit: 'score',
          aggregation: 'AVG',
          granularity: 'Monthly',
          sourceTables: ['gold.fact_customer_satisfaction'],
        },
        {
          id: 'CUST-EXP-002',
          name: 'Customer Satisfaction Index',
          description: 'Composite satisfaction score',
          formula: "SELECT AVG((product_satisfaction + service_satisfaction + value_satisfaction + support_satisfaction) / 4)",
          businessLogic: 'Average of satisfaction dimensions',
          dataType: 'DECIMAL',
          unit: 'score',
          aggregation: 'AVG',
          granularity: 'Monthly',
          sourceTables: ['gold.fact_customer_satisfaction'],
        },
        {
          id: 'CUST-EXP-003',
          name: 'Customer Effort Score',
          description: 'Ease of doing business with bank',
          formula: "SELECT AVG(effort_score) FROM gold.fact_customer_satisfaction",
          businessLogic: 'Average effort score',
          dataType: 'DECIMAL',
          unit: 'score',
          aggregation: 'AVG',
          granularity: 'Monthly',
          sourceTables: ['gold.fact_customer_satisfaction'],
        },
        {
          id: 'CUST-EXP-004',
          name: 'Response Time to Inquiries',
          description: 'Average hours to respond to customer inquiry',
          formula: "SELECT AVG(DATEDIFF(hour, inquiry_timestamp, response_timestamp)) FROM gold.fact_customer_interactions",
          businessLogic: 'Average response time',
          dataType: 'DECIMAL',
          unit: 'hours',
          aggregation: 'AVG',
          granularity: 'Monthly',
          sourceTables: ['gold.fact_customer_interactions'],
        },
        {
          id: 'CUST-EXP-005',
          name: 'First-Contact Resolution Rate',
          description: 'Percentage of issues resolved on first contact',
          formula: "SELECT (COUNT(CASE WHEN resolution_count = 1 THEN 1 END) / NULLIF(COUNT(*), 0)) * 100",
          businessLogic: 'One-contact resolutions / Total',
          dataType: 'DECIMAL',
          unit: 'percentage',
          aggregation: 'AVG',
          granularity: 'Monthly',
          sourceTables: ['gold.fact_customer_interactions'],
        },
        {
          id: 'CUST-EXP-006',
          name: 'Support Request Volume',
          description: 'Total customer support interactions',
          formula: "SELECT COUNT(*) FROM gold.fact_customer_interactions",
          businessLogic: 'Count of support interactions',
          dataType: 'INTEGER',
          unit: 'count',
          aggregation: 'SUM',
          granularity: 'Monthly',
          sourceTables: ['gold.fact_customer_interactions'],
        },
        {
          id: 'CUST-EXP-007',
          name: 'Issue Resolution Time',
          description: 'Average days to fully resolve issues',
          formula: "SELECT AVG(DATEDIFF(day, issue_open_date, issue_close_date)) FROM gold.fact_customer_interactions",
          businessLogic: 'Average resolution timeline',
          dataType: 'DECIMAL',
          unit: 'days',
          aggregation: 'AVG',
          granularity: 'Monthly',
          sourceTables: ['gold.fact_customer_interactions'],
        },
        {
          id: 'CUST-EXP-008',
          name: 'Customer Recommendation Rate',
          description: 'Percentage of customers likely to recommend',
          formula: "SELECT (COUNT(CASE WHEN nps_score >= 9 THEN 1 END) / NULLIF(COUNT(*), 0)) * 100",
          businessLogic: 'Promoters / Total responses',
          dataType: 'DECIMAL',
          unit: 'percentage',
          aggregation: 'AVG',
          granularity: 'Monthly',
          sourceTables: ['gold.fact_customer_satisfaction'],
        },
      ],
    },
  ],
};

export const customerMetricsComplete = {
  metrics: customerMetricsCatalog,
  totalMetrics: customerMetricsCatalog.totalMetrics,
  description: 'Complete customer domain metrics catalog with SQL formulas and business logic',
};
