/**
 * FRAUD-RETAIL ERD DEFINITIONS
 * 
 * Logical and Physical ERD definitions for fraud detection and prevention
 * Sources: Fraud management systems, Transaction monitoring, Case management
 */

// LOGICAL ERD - Business Model
export const fraudRetailLogicalERD = {
  entities: [
    {
      name: 'Fraud Alert',
      type: 'event',
      description: 'Fraud detection alerts and cases',
      attributes: [
        { name: 'alert_id', type: 'BIGINT', isPrimaryKey: true },
        { name: 'customer_id', type: 'BIGINT', isForeignKey: true },
        { name: 'account_id', type: 'BIGINT', isForeignKey: true },
        { name: 'transaction_id', type: 'BIGINT', isForeignKey: true, description: 'Related transaction if applicable' },
        { name: 'alert_timestamp', type: 'TIMESTAMP', description: 'When alert was generated' },
        { name: 'alert_type', type: 'STRING', description: 'Transaction|Account Takeover|Identity Theft|Application Fraud' },
        { name: 'fraud_scenario', type: 'STRING', description: 'Card Not Present|ATM Skimming|Check Fraud|Wire Fraud' },
        { name: 'alert_severity', type: 'STRING', description: 'Low|Medium|High|Critical' },
        { name: 'risk_score', type: 'INTEGER', description: 'Risk score 0-1000' },
        { name: 'alert_status', type: 'STRING', description: 'New|Under Review|Confirmed Fraud|False Positive|Closed' },
        { name: 'detection_method', type: 'STRING', description: 'Rules Engine|ML Model|Customer Report|Manual' },
        { name: 'detection_rule_id', type: 'STRING', description: 'Rule/model that triggered' },
      ],
    },
    {
      name: 'Fraud Case',
      type: 'core',
      description: 'Fraud investigation cases',
      attributes: [
        { name: 'case_id', type: 'BIGINT', isPrimaryKey: true },
        { name: 'alert_id', type: 'BIGINT', isForeignKey: true },
        { name: 'customer_id', type: 'BIGINT', isForeignKey: true },
        { name: 'case_number', type: 'STRING', description: 'Unique case identifier' },
        { name: 'case_created_timestamp', type: 'TIMESTAMP' },
        { name: 'case_status', type: 'STRING', description: 'Open|In Progress|Escalated|Resolved|Closed' },
        { name: 'case_priority', type: 'STRING', description: 'Low|Medium|High|Urgent' },
        { name: 'assigned_investigator_id', type: 'BIGINT', isForeignKey: true },
        { name: 'fraud_type', type: 'STRING', description: 'First Party|Third Party|Synthetic Identity' },
        { name: 'investigation_status', type: 'STRING', description: 'Initiated|Investigating|Pending Documents|Completed' },
        { name: 'resolution', type: 'STRING', description: 'Confirmed Fraud|Not Fraud|Inconclusive' },
        { name: 'resolution_timestamp', type: 'TIMESTAMP' },
        { name: 'fraud_amount', type: 'DECIMAL(18,2)', description: 'Total fraud amount' },
        { name: 'recovered_amount', type: 'DECIMAL(18,2)', description: 'Amount recovered' },
      ],
    },
    {
      name: 'Disputed Transaction',
      type: 'event',
      description: 'Customer-disputed transactions',
      attributes: [
        { name: 'dispute_id', type: 'BIGINT', isPrimaryKey: true },
        { name: 'transaction_id', type: 'BIGINT', isForeignKey: true },
        { name: 'customer_id', type: 'BIGINT', isForeignKey: true },
        { name: 'account_id', type: 'BIGINT', isForeignKey: true },
        { name: 'dispute_timestamp', type: 'TIMESTAMP' },
        { name: 'dispute_reason', type: 'STRING', description: 'Unauthorized|Error|Service Not Received|Other' },
        { name: 'dispute_amount', type: 'DECIMAL(18,2)' },
        { name: 'dispute_status', type: 'STRING', description: 'Submitted|Under Review|Approved|Denied|Closed' },
        { name: 'provisional_credit_issued', type: 'BOOLEAN' },
        { name: 'provisional_credit_amount', type: 'DECIMAL(18,2)' },
        { name: 'resolution_date', type: 'DATE' },
        { name: 'chargeback_filed', type: 'BOOLEAN' },
      ],
    },
    {
      name: 'Fraud Rule',
      type: 'configuration',
      description: 'Fraud detection rules and thresholds',
      attributes: [
        { name: 'rule_id', type: 'STRING', isPrimaryKey: true },
        { name: 'rule_name', type: 'STRING' },
        { name: 'rule_description', type: 'TEXT' },
        { name: 'rule_category', type: 'STRING', description: 'Velocity|Amount|Location|Device|Behavior' },
        { name: 'rule_logic', type: 'TEXT', description: 'Rule definition' },
        { name: 'threshold_value', type: 'DECIMAL(18,2)', description: 'Threshold for triggering' },
        { name: 'risk_score_weight', type: 'INTEGER', description: 'Score contribution 0-100' },
        { name: 'rule_status', type: 'STRING', description: 'Active|Inactive|Testing' },
        { name: 'effective_date', type: 'DATE' },
        { name: 'last_updated', type: 'TIMESTAMP' },
      ],
    },
    {
      name: 'Card Block',
      type: 'event',
      description: 'Card blocks and restrictions due to fraud',
      attributes: [
        { name: 'block_id', type: 'BIGINT', isPrimaryKey: true },
        { name: 'card_id', type: 'BIGINT', isForeignKey: true },
        { name: 'customer_id', type: 'BIGINT', isForeignKey: true },
        { name: 'block_timestamp', type: 'TIMESTAMP' },
        { name: 'block_reason', type: 'STRING', description: 'Fraud Suspected|Lost/Stolen|Customer Request|Compromised' },
        { name: 'block_type', type: 'STRING', description: 'Full Block|Transaction Type Block|Geographic Block' },
        { name: 'block_status', type: 'STRING', description: 'Active|Lifted|Permanent' },
        { name: 'lift_timestamp', type: 'TIMESTAMP', description: 'When block was removed' },
        { name: 'initiated_by', type: 'STRING', description: 'System|Customer|Agent|Fraud Team' },
      ],
    },
    {
      name: 'Compromised Customer',
      type: 'core',
      description: 'Customers affected by data breaches',
      attributes: [
        { name: 'compromise_id', type: 'BIGINT', isPrimaryKey: true },
        { name: 'customer_id', type: 'BIGINT', isForeignKey: true },
        { name: 'breach_event_id', type: 'STRING', isForeignKey: true },
        { name: 'compromise_date', type: 'DATE' },
        { name: 'compromised_data_type', type: 'STRING', description: 'Card Number|SSN|PII|Credentials' },
        { name: 'notification_sent', type: 'BOOLEAN' },
        { name: 'notification_date', type: 'DATE' },
        { name: 'card_reissued', type: 'BOOLEAN' },
        { name: 'card_reissue_date', type: 'DATE' },
        { name: 'monitoring_enabled', type: 'BOOLEAN', description: 'Credit monitoring offered' },
      ],
    },
    {
      name: 'Suspicious Activity Report',
      type: 'regulatory',
      description: 'SARs filed for suspicious activity',
      attributes: [
        { name: 'sar_id', type: 'BIGINT', isPrimaryKey: true },
        { name: 'customer_id', type: 'BIGINT', isForeignKey: true },
        { name: 'case_id', type: 'BIGINT', isForeignKey: true },
        { name: 'sar_number', type: 'STRING', description: 'FinCEN SAR number' },
        { name: 'filing_date', type: 'DATE' },
        { name: 'activity_date_from', type: 'DATE' },
        { name: 'activity_date_to', type: 'DATE' },
        { name: 'total_amount', type: 'DECIMAL(18,2)' },
        { name: 'suspicious_activity_type', type: 'STRING', description: 'Money Laundering|Terrorist Financing|Fraud|Other' },
        { name: 'filed_by', type: 'STRING' },
        { name: 'status', type: 'STRING', description: 'Draft|Filed|Accepted|Rejected' },
      ],
    },
    {
      name: 'Fraud Investigator',
      type: 'core',
      description: 'Fraud investigation staff',
      attributes: [
        { name: 'investigator_id', type: 'BIGINT', isPrimaryKey: true },
        { name: 'employee_id', type: 'BIGINT', isForeignKey: true },
        { name: 'investigator_name', type: 'STRING' },
        { name: 'specialization', type: 'STRING', description: 'Card Fraud|Wire Fraud|AML|Identity Theft' },
        { name: 'certification', type: 'STRING', description: 'CFE|CAMS|CFCI' },
        { name: 'active_flag', type: 'BOOLEAN' },
        { name: 'hire_date', type: 'DATE' },
      ],
    },
  ],
  
  relationships: [
    {
      from: 'Fraud Case',
      to: 'Fraud Alert',
      type: 'one-to-one',
      cardinality: '1:1',
      foreignKey: 'alert_id',
      description: 'Case from alert',
    },
    {
      from: 'Fraud Case',
      to: 'Fraud Investigator',
      type: 'many-to-one',
      cardinality: 'N:1',
      foreignKey: 'assigned_investigator_id',
      description: 'Investigator handles cases',
    },
    {
      from: 'Disputed Transaction',
      to: 'Fraud Alert',
      type: 'many-to-one',
      cardinality: 'N:1',
      foreignKey: 'transaction_id',
      description: 'Disputes may trigger alerts',
    },
    {
      from: 'Card Block',
      to: 'Fraud Alert',
      type: 'many-to-one',
      cardinality: 'N:1',
      foreignKey: 'card_id',
      description: 'Blocks from alerts',
    },
    {
      from: 'Suspicious Activity Report',
      to: 'Fraud Case',
      type: 'one-to-one',
      cardinality: '1:1',
      foreignKey: 'case_id',
      description: 'SAR from case',
    },
    {
      from: 'Fraud Alert',
      to: 'Fraud Rule',
      type: 'many-to-one',
      cardinality: 'N:1',
      foreignKey: 'detection_rule_id',
      description: 'Alert from rule',
    },
  ],
};

// PHYSICAL ERD - Technical Implementation
export const fraudRetailPhysicalERD = {
  tables: [
    {
      name: 'bronze.retail_fraud_alerts',
      description: 'Fraud detection alerts',
      source: 'Fraud Detection System',
      updateFrequency: 'Real-time',
      recordCount: '~10M alerts/year',
      attributes: [
        { name: 'alert_id', type: 'BIGINT', isPrimaryKey: true },
        { name: 'customer_id', type: 'BIGINT' },
        { name: 'account_id', type: 'BIGINT' },
        { name: 'transaction_id', type: 'BIGINT' },
        { name: 'alert_timestamp', type: 'TIMESTAMP' },
        { name: 'alert_type', type: 'VARCHAR(100)' },
        { name: 'fraud_scenario', type: 'VARCHAR(100)' },
        { name: 'alert_severity', type: 'VARCHAR(50)' },
        { name: 'risk_score', type: 'INTEGER' },
        { name: 'alert_status', type: 'VARCHAR(50)' },
        { name: 'detection_method', type: 'VARCHAR(100)' },
        { name: 'detection_rule_id', type: 'VARCHAR(100)' },
        { name: 'created_timestamp', type: 'TIMESTAMP' },
        { name: 'updated_timestamp', type: 'TIMESTAMP' },
        { name: 'source_system', type: 'VARCHAR(50)' },
      ],
    },
    {
      name: 'bronze.retail_fraud_cases',
      description: 'Fraud investigation cases',
      source: 'Fraud Case Management System',
      updateFrequency: 'Real-time',
      recordCount: '~500K cases/year',
      attributes: [
        { name: 'case_id', type: 'BIGINT', isPrimaryKey: true },
        { name: 'alert_id', type: 'BIGINT' },
        { name: 'customer_id', type: 'BIGINT' },
        { name: 'case_number', type: 'VARCHAR(50)' },
        { name: 'case_created_timestamp', type: 'TIMESTAMP' },
        { name: 'case_status', type: 'VARCHAR(50)' },
        { name: 'case_priority', type: 'VARCHAR(50)' },
        { name: 'assigned_investigator_id', type: 'BIGINT' },
        { name: 'fraud_type', type: 'VARCHAR(100)' },
        { name: 'investigation_status', type: 'VARCHAR(50)' },
        { name: 'resolution', type: 'VARCHAR(100)' },
        { name: 'resolution_timestamp', type: 'TIMESTAMP' },
        { name: 'fraud_amount', type: 'DECIMAL(18,2)' },
        { name: 'recovered_amount', type: 'DECIMAL(18,2)' },
        { name: 'created_timestamp', type: 'TIMESTAMP' },
        { name: 'updated_timestamp', type: 'TIMESTAMP' },
        { name: 'source_system', type: 'VARCHAR(50)' },
      ],
    },
    {
      name: 'bronze.retail_disputed_transactions',
      description: 'Customer transaction disputes',
      source: 'Dispute Management System',
      updateFrequency: 'Real-time',
      recordCount: '~2M disputes/year',
      attributes: [
        { name: 'dispute_id', type: 'BIGINT', isPrimaryKey: true },
        { name: 'transaction_id', type: 'BIGINT' },
        { name: 'customer_id', type: 'BIGINT' },
        { name: 'account_id', type: 'BIGINT' },
        { name: 'dispute_timestamp', type: 'TIMESTAMP' },
        { name: 'dispute_reason', type: 'VARCHAR(200)' },
        { name: 'dispute_amount', type: 'DECIMAL(18,2)' },
        { name: 'dispute_status', type: 'VARCHAR(50)' },
        { name: 'provisional_credit_issued', type: 'BOOLEAN' },
        { name: 'provisional_credit_amount', type: 'DECIMAL(18,2)' },
        { name: 'resolution_date', type: 'DATE' },
        { name: 'chargeback_filed', type: 'BOOLEAN' },
        { name: 'created_timestamp', type: 'TIMESTAMP' },
        { name: 'updated_timestamp', type: 'TIMESTAMP' },
        { name: 'source_system', type: 'VARCHAR(50)' },
      ],
    },
    {
      name: 'bronze.retail_fraud_rules',
      description: 'Fraud detection rules configuration',
      source: 'Fraud Rules Engine',
      updateFrequency: 'Daily',
      recordCount: '~500 active rules',
      attributes: [
        { name: 'rule_id', type: 'VARCHAR(100)', isPrimaryKey: true },
        { name: 'rule_name', type: 'VARCHAR(200)' },
        { name: 'rule_description', type: 'TEXT' },
        { name: 'rule_category', type: 'VARCHAR(100)' },
        { name: 'rule_logic', type: 'TEXT' },
        { name: 'threshold_value', type: 'DECIMAL(18,2)' },
        { name: 'risk_score_weight', type: 'INTEGER' },
        { name: 'rule_status', type: 'VARCHAR(50)' },
        { name: 'effective_date', type: 'DATE' },
        { name: 'last_updated', type: 'TIMESTAMP' },
        { name: 'created_timestamp', type: 'TIMESTAMP' },
        { name: 'source_system', type: 'VARCHAR(50)' },
      ],
    },
    {
      name: 'bronze.retail_card_blocks',
      description: 'Card blocks and restrictions',
      source: 'Card Management System',
      updateFrequency: 'Real-time',
      recordCount: '~1M blocks/year',
      attributes: [
        { name: 'block_id', type: 'BIGINT', isPrimaryKey: true },
        { name: 'card_id', type: 'BIGINT' },
        { name: 'customer_id', type: 'BIGINT' },
        { name: 'block_timestamp', type: 'TIMESTAMP' },
        { name: 'block_reason', type: 'VARCHAR(200)' },
        { name: 'block_type', type: 'VARCHAR(50)' },
        { name: 'block_status', type: 'VARCHAR(50)' },
        { name: 'lift_timestamp', type: 'TIMESTAMP' },
        { name: 'initiated_by', type: 'VARCHAR(100)' },
        { name: 'created_timestamp', type: 'TIMESTAMP' },
        { name: 'updated_timestamp', type: 'TIMESTAMP' },
        { name: 'source_system', type: 'VARCHAR(50)' },
      ],
    },
    {
      name: 'bronze.retail_compromised_customers',
      description: 'Customers affected by breaches',
      source: 'Breach Notification System',
      updateFrequency: 'Daily',
      recordCount: '~Variable by breach',
      attributes: [
        { name: 'compromise_id', type: 'BIGINT', isPrimaryKey: true },
        { name: 'customer_id', type: 'BIGINT' },
        { name: 'breach_event_id', type: 'VARCHAR(100)' },
        { name: 'compromise_date', type: 'DATE' },
        { name: 'compromised_data_type', type: 'VARCHAR(100)' },
        { name: 'notification_sent', type: 'BOOLEAN' },
        { name: 'notification_date', type: 'DATE' },
        { name: 'card_reissued', type: 'BOOLEAN' },
        { name: 'card_reissue_date', type: 'DATE' },
        { name: 'monitoring_enabled', type: 'BOOLEAN' },
        { name: 'created_timestamp', type: 'TIMESTAMP' },
        { name: 'updated_timestamp', type: 'TIMESTAMP' },
        { name: 'source_system', type: 'VARCHAR(50)' },
      ],
    },
    {
      name: 'bronze.retail_sars',
      description: 'Suspicious Activity Reports',
      source: 'BSA/AML System',
      updateFrequency: 'Daily',
      recordCount: '~50K SARs/year',
      attributes: [
        { name: 'sar_id', type: 'BIGINT', isPrimaryKey: true },
        { name: 'customer_id', type: 'BIGINT' },
        { name: 'case_id', type: 'BIGINT' },
        { name: 'sar_number', type: 'VARCHAR(50)' },
        { name: 'filing_date', type: 'DATE' },
        { name: 'activity_date_from', type: 'DATE' },
        { name: 'activity_date_to', type: 'DATE' },
        { name: 'total_amount', type: 'DECIMAL(18,2)' },
        { name: 'suspicious_activity_type', type: 'VARCHAR(200)' },
        { name: 'filed_by', type: 'VARCHAR(200)' },
        { name: 'status', type: 'VARCHAR(50)' },
        { name: 'created_timestamp', type: 'TIMESTAMP' },
        { name: 'updated_timestamp', type: 'TIMESTAMP' },
        { name: 'source_system', type: 'VARCHAR(50)' },
      ],
    },
    {
      name: 'bronze.retail_fraud_investigators',
      description: 'Fraud investigation staff',
      source: 'HR System',
      updateFrequency: 'Daily',
      recordCount: '~500 investigators',
      attributes: [
        { name: 'investigator_id', type: 'BIGINT', isPrimaryKey: true },
        { name: 'employee_id', type: 'BIGINT' },
        { name: 'investigator_name', type: 'VARCHAR(200)' },
        { name: 'specialization', type: 'VARCHAR(100)' },
        { name: 'certification', type: 'VARCHAR(100)' },
        { name: 'active_flag', type: 'BOOLEAN' },
        { name: 'hire_date', type: 'DATE' },
        { name: 'created_timestamp', type: 'TIMESTAMP' },
        { name: 'updated_timestamp', type: 'TIMESTAMP' },
        { name: 'source_system', type: 'VARCHAR(50)' },
      ],
    },
  ],
  
  relationships: [
    {
      from: 'bronze.retail_fraud_cases',
      to: 'bronze.retail_fraud_alerts',
      type: 'one-to-one',
      cardinality: '1:1',
      foreignKey: 'alert_id',
      description: 'Case from alert',
    },
    {
      from: 'bronze.retail_fraud_cases',
      to: 'bronze.retail_fraud_investigators',
      type: 'many-to-one',
      cardinality: 'N:1',
      foreignKey: 'assigned_investigator_id',
      description: 'Investigator assigned to cases',
    },
    {
      from: 'bronze.retail_sars',
      to: 'bronze.retail_fraud_cases',
      type: 'one-to-one',
      cardinality: '1:1',
      foreignKey: 'case_id',
      description: 'SAR filed for case',
    },
    {
      from: 'bronze.retail_card_blocks',
      to: 'bronze.retail_fraud_alerts',
      type: 'many-to-one',
      cardinality: 'N:1',
      foreignKey: 'card_id',
      description: 'Blocks from alerts',
    },
  ],
};

// Export default for easy import
export default {
  fraudRetailLogicalERD,
  fraudRetailPhysicalERD,
};
